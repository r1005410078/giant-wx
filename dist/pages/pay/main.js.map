require("../../common/manifest.js.map");
require("../../common/vendor.js.map");
{"version":3,"sources":["webpack:///./src/pages/pay/main.js","webpack:///./src/pages/pay/index.vue","webpack:///./src/pages/pay/index.vue?e342","webpack:///src/pages/pay/index.vue","webpack:///./src/pages/pay/index.vue?f62c"],"names":["app","$mount"],"mappings":";;;;;;;;;;AAAA;AACA;;AAEA,IAAMA,MAAM,IAAI,2CAAJ,CAAQ,uDAAR,CAAZ;AACAA,IAAIC,MAAJ,G;;;;;;;;;ACJA;AAAA;AACA;AACA;AACA,yBAAiZ;AACjZ;AACA;AACA;AACA;AACA;AACqP;AACrP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA+E,sDAAsD,IAAI;AACzI,mCAAmC;;AAEnC;AACA,YAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;AAED;;;;;;;;AC3CA,yC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8BA;AACA;AACA;AACA;AACA,eADA,yBACA;AACA,sFACA,MADA,CACA;AAAA;AAAA,OADA,EAEA,GAFA,CAEA;AACA;AACA;AAAA;AAAA,YADA;AAEA;AAFA;AAIA,OAPA;AAQA;AAVA,GADA;AAaA,MAbA,kBAaA;AACA;AACA,kBADA;AAEA,iBACA,yCADA,EAEA,2BAFA,EAGA,0BAHA;AAFA;AAQA,GAtBA;AAuBA,QAvBA,oBAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAjCA;;AAkCA;AACA,kBADA,0BACA,CADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,KAPA;AAQA,aARA,qBAQA,CARA,EAQA;AACA;AACA;AACA;AACA;AACA;AACA,KAdA;AAeA,YAfA,oBAeA,GAfA,EAeA,GAfA,EAeA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,oBADA,GACA,KADA;;AAEA;;AAFA,sBAGA,oBAHA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKA,gHALA;;AAAA;AAKA,sBALA;AAMA,mBANA,GAMA,WANA;AAOA,sBAPA,GAOA;AACA,6CADA;AAEA,2CAFA;AAGA,wCAHA;AAIA,2CAJA;AAKA,yCALA;AAMA;AACA;AACA,sDADA;AAEA,uCAFA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAVA;AAYA,mBAnBA;AAoBA;AACA;AACA;AACA,0DADA;AAEA,yCAFA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAVA;AAYA,qBAbA,MAaA;AACA;AACA,8CADA;AAEA,oCAFA;AAGA;AAHA;AAKA;AACA;AAzCA,iBAPA;;AAkDA;AAlDA;AAAA;;AAAA;AAoDA;AACA,mDADA;AAEA,mCAFA;AAGA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAXA;;AApDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkEA,KAjFA;AAkFA,cAlFA,sBAkFA,CAlFA,EAkFA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,mBADA,GACA,cADA;;AAAA,oBAEA,cAFA;AAAA;AAAA;AAAA;;AAAA,kDAGA;AACA,mCADA;AAEA;AAFA,kBAHA;;AAAA;AAQA,+BARA,GAQA;AACA,wCADA;AAEA,4CAFA;AAGA;AAHA,iBARA;AAAA;AAAA,uBAaA,oGAbA;;AAAA;AAaA,mBAbA;;AAcA;;AAdA,sBAeA,sBAfA;AAAA;AAAA;AAAA;;AAgBA;AACA;AACA,+BADA;AAEA,qCAFA;AAGA,oCAHA;AAIA,kCAJA;AAKA,kCALA;AAMA;AACA;AACA;AACA;AACA;AAVA;AAjBA;;AAAA;;AAgCA;AACA;AACA,6EADA;AAEA,+BAFA;AAGA,2CAHA;AAIA,uCAJA;AAKA,oCALA;AAMA,oCANA;AAOA;AACA;AACA;AACA,uBAFA,MAEA;AACA;AACA,4DADA;AAEA,2CAFA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAVA;AAYA;AACA;AAxBA;AA0BA,iBA3BA,MA2BA;AACA;AACA;;AA7DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA8DA,KAhJA;AAiJA,oBAjJA,8BAiJA;AACA;AACA;AACA,OAFA,EAEA,GAFA;AAGA;AArJA;AAwJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAjNA,G;;;;;;;;AChCA,0BAA0B,aAAa,0BAA0B;AACjE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,C","file":"pages\\pay\\main.js","sourcesContent":["import Vue from 'vue'\r\nimport App from './index'\r\n\r\nconst app = new Vue(App)\r\napp.$mount()\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pay/main.js","var disposed = false\nfunction injectStyle (ssrContext) {\n  if (disposed) return\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":false,\\\"sourceMap\\\":false}!../../../node_modules/mpvue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a4db1dd\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!px2rpx-loader?{\\\"baseDpr\\\":1,\\\"rpxUnit\\\":0.5}!postcss-loader?{\\\"sourceMap\\\":true}!../../../node_modules/mpvue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/mpvue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/mpvue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/mpvue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0a4db1dd\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../../node_modules/mpvue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0a4db1dd\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"src\\\\pages\\\\pay\\\\index.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key.substr(0, 2) !== \"__\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] index.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-0a4db1dd\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-0a4db1dd\", Component.options)\n  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/pay/index.vue\n// module id = 209\n// module chunks = 7","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"minimize\":false,\"sourceMap\":false}!./node_modules/mpvue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-0a4db1dd\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/px2rpx-loader?{\"baseDpr\":1,\"rpxUnit\":0.5}!./node_modules/postcss-loader/lib?{\"sourceMap\":true}!./node_modules/mpvue-loader/lib/selector.js?type=styles&index=0!./src/pages/pay/index.vue\n// module id = 210\n// module chunks = 7","<template>\r\n  <div>\r\n    <form @submit=\"formSubmit\" bindreset=\"formReset\" :report-submit=\"true\">\r\n      <div class=\"weui-cells__title\">支付方式</div>\r\n        <div class=\"weui-cells weui-cells_after-title\">\r\n          <radio-group name=\"pay_type\" class=\"radio-group\">\r\n            <label v-for=\"item in payItems\" :key=\"item.value\" class=\"weui-cell weui-check__label\" >\r\n              <span class=\"text\">{{item.name}}</span>\r\n              <radio class=\"weui-cell__ft weui-cell__ft_in-radio\" :value=\"item.value\" :checked=\"item.checked\"/>\r\n            </label>\r\n          </radio-group>\r\n      </div>\r\n      <div class=\"weui-cells__title\" style=\"color: red\">温馨提醒：因为押金是原路径退回，尽量选择余额支付，以免影响到账时间。</div>\r\n      <div class=\"weui-cells__title\">所在驿站</div>\r\n      <div class=\"weui-cells weui-cells_after-title\">\r\n        <radio-group name=\"station_id\" class=\"radio-group\">\r\n          <label v-for=\"item in stations\" :key=\"item.id\" class=\"weui-cell weui-check__label\" >\r\n            <span class=\"text\">{{item.name}}</span>\r\n            <radio class=\"weui-cell__ft weui-cell__ft_in-radio\" :value=\"item.id\" :checked=\"item.checked\"/>\r\n          </label>\r\n        </radio-group>\r\n      </div>\r\n      <div class=\"weui-btn-area\">\r\n        <button formType=\"submit\" class=\"weui-btn\" type=\"primary\">提交租车订单</button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '../getApi'\r\nimport store from '../index/store'\r\nexport default {\r\n  computed: {\r\n    selectCombo () {\r\n      return store.state.list\r\n        .filter(item => item.car_list.length > 0)\r\n        .map(item => {\r\n          return {\r\n            bike_list: item.car_list.map(car => car.id),\r\n            combo_id: item.id\r\n          }\r\n        })\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      stations: [],\r\n      payItems: [\r\n        {name: '微信', value: '1', checked: true},\r\n        {name: '支付宝', value: '2'},\r\n        {name: '现金', value: '3'}\r\n      ]\r\n    }\r\n  },\r\n  onLoad () {\r\n    this.stations = store.state.stations\r\n    // .map((station, index) => {\r\n    //   if (index === 0) {\r\n    //     station.checked = true\r\n    //   } else {\r\n    //     station.checked = false\r\n    //   }\r\n    //   return station\r\n    // })\r\n  },\r\n  methods: {\r\n    locationChange (e) {\r\n      const stations = this.stations.slice()\r\n      for (let i = 0, len = stations.length; i < len; ++i) {\r\n        stations[i].checked = stations[i].id === Number(e.target.value)\r\n      }\r\n      this.stations = stations\r\n    },\r\n    payChange (e) {\r\n      const payItems = this.payItems.slice()\r\n      for (let i = 0, len = payItems.length; i < len; ++i) {\r\n        payItems[i].checked = payItems[i].value === e.target.value\r\n      }\r\n      this.payItems = payItems\r\n    },\r\n    async payOrder (res, val) {\r\n      const that = this\r\n      this.order_no = res.data.order_no\r\n      if (val.pay_type === '1') {\r\n        // 微信支付\r\n        const result = await api.payOrder.post({ order_no: this.order_no }).toPromise()\r\n        const ret = result.data\r\n        const params = {\r\n          'timeStamp': ret.time_stamp,\r\n          'nonceStr': ret.nonce_str,\r\n          'package': ret.package,\r\n          'signType': ret.sign_type,\r\n          'paySign': ret.pay_sign,\r\n          success: res => {\r\n            wx.showModal({\r\n              content: '押金支付成功，该订单可以在我的订单里面查询',\r\n              showCancel: false,\r\n              success: function (res) {\r\n                if (res.confirm) {\r\n                  wx.navigateBack({\r\n                    delta: 1\r\n                  })\r\n                  that.hideTabBarRedDot()\r\n                }\r\n              }\r\n            })\r\n          },\r\n          fail: error => {\r\n            if (error.errMsg === 'requestPayment:fail cancel') {\r\n              wx.showModal({\r\n                content: '订单创建成功, 请去我的订单中的待付押金中支付',\r\n                showCancel: false,\r\n                success: function (res) {\r\n                  if (res.confirm) {\r\n                    wx.navigateBack({\r\n                      delta: 1\r\n                    })\r\n                    that.hideTabBarRedDot({index: 1})\r\n                  }\r\n                }\r\n              })\r\n            } else {\r\n              wx.showToast({\r\n                title: '支付失败：' + error,\r\n                icon: 'none',\r\n                duration: 5000\r\n              })\r\n            }\r\n          }\r\n        }\r\n        wx.requestPayment(params)\r\n      } else {\r\n        wx.showModal({\r\n          content: '订单创建成功, 请联系店长扫码支付或现金支付',\r\n          showCancel: false,\r\n          success: function (res) {\r\n            if (res.confirm) {\r\n              // console.log('用户点击确定')\r\n              wx.navigateBack({\r\n                delta: 1\r\n              })\r\n              that.hideTabBarRedDot({index: 1})\r\n            }\r\n          }\r\n        })\r\n      }\r\n    },\r\n    async formSubmit (e) {\r\n      const val = e.target.value\r\n      if (!val.station_id) {\r\n        return wx.showToast({\r\n          title: '请选择正确的驿站',\r\n          duration: 5000\r\n        })\r\n      }\r\n      const payCreateParmas = {\r\n        pay_type: val.pay_type,\r\n        station_id: val.station_id,\r\n        combo_bike: this.selectCombo\r\n      }\r\n      const res = await api.payCreate.post(payCreateParmas).toPromise()\r\n      store.commit('clearShop')\r\n      if (res.error_code === 409) {\r\n        // wx.navigateTo({url: '/pages/userinfo/main'})\r\n        wx.showModal({\r\n          title: '提交失败',\r\n          content: '请先绑定手机号!',\r\n          confirmText: '去绑定',\r\n          cancelText: '取消',\r\n          showCancel: true,\r\n          success: function (res) {\r\n            if (res.confirm) {\r\n              wx.navigateTo({url: '/pages/userinfo/main'})\r\n            }\r\n          }\r\n        })\r\n        return\r\n      }\r\n\r\n      if (val.pay_type === '1') {\r\n        wx.showModal({\r\n          title: `支付押金 ￥${res.data.money}`,\r\n          content: '',\r\n          confirmColor: '#0099FF',\r\n          confirmText: '确定支付',\r\n          cancelText: '返回',\r\n          showCancel: true,\r\n          success: (ret) => {\r\n            if (ret.confirm) {\r\n              this.payOrder(res, val)\r\n            } else {\r\n              wx.showModal({\r\n                content: '订单创建成功, 请去我的订单中的待付押金中支付',\r\n                showCancel: false,\r\n                success: (res) => {\r\n                  if (res.confirm) {\r\n                    wx.navigateBack({\r\n                      delta: 1\r\n                    })\r\n                    this.hideTabBarRedDot({index: 1})\r\n                  }\r\n                }\r\n              })\r\n            }\r\n          }\r\n        })\r\n      } else {\r\n        this.payOrder(res, val)\r\n      }\r\n    },\r\n    hideTabBarRedDot () {\r\n      setTimeout(() => {\r\n        wx.hideTabBarRedDot({index: 1})\r\n      }, 500)\r\n    }\r\n  }\r\n}\r\n// this.selectCombo.forEach((item, index) => {\r\n//   const id = item.combo_id\r\n//   for (let l = 0; l < store.state.list.length; l++) {\r\n//     const it = store.state.list[l];\r\n//     if (id === it.id) {\r\n//       const bike_count = it.bike_count\r\n//       const list = item.bike_list\r\n//       const num = list.length / bike_count\r\n//       if (num > 1) {\r\n//         for (let index = 0; index < num; index++) {\r\n//           const bike_list = []\r\n//           for (let j = 0; j < bike_count; j++) {\r\n//             bike_list.push(list.pop())\r\n//           }\r\n//           this.selectCombo.push({\r\n//             bike_list,\r\n//             combo_id: it.id\r\n//           })\r\n//         }\r\n//       }\r\n//       break\r\n//     }\r\n//   }\r\n// });\r\n</script>\r\n\r\n<style scoped>\r\n  .weui-cell__ft_in-radio {\r\n    position: absolute;\r\n    right: 15px;\r\n  }\r\n</style>\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/pay/index.vue?42ecd145","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('form', {\n    attrs: {\n      \"bindreset\": \"formReset\",\n      \"report-submit\": true,\n      \"eventid\": '0'\n    },\n    on: {\n      \"submit\": _vm.formSubmit\n    }\n  }, [_c('div', {\n    staticClass: \"weui-cells__title\"\n  }, [_vm._v(\"支付方式\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"weui-cells weui-cells_after-title\"\n  }, [_c('radio-group', {\n    staticClass: \"radio-group\",\n    attrs: {\n      \"name\": \"pay_type\",\n      \"mpcomid\": '0'\n    }\n  }, _vm._l((_vm.payItems), function(item, index) {\n    return _c('label', {\n      key: item.value,\n      staticClass: \"weui-cell weui-check__label\"\n    }, [_c('span', {\n      staticClass: \"text\"\n    }, [_vm._v(_vm._s(item.name))]), _vm._v(\" \"), _c('radio', {\n      staticClass: \"weui-cell__ft weui-cell__ft_in-radio\",\n      attrs: {\n        \"value\": item.value,\n        \"checked\": item.checked\n      }\n    })], 1)\n  }))], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"weui-cells__title\",\n    staticStyle: {\n      \"color\": \"red\"\n    }\n  }, [_vm._v(\"温馨提醒：因为押金是原路径退回，尽量选择余额支付，以免影响到账时间。\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"weui-cells__title\"\n  }, [_vm._v(\"所在驿站\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"weui-cells weui-cells_after-title\"\n  }, [_c('radio-group', {\n    staticClass: \"radio-group\",\n    attrs: {\n      \"name\": \"station_id\",\n      \"mpcomid\": '1'\n    }\n  }, _vm._l((_vm.stations), function(item, index) {\n    return _c('label', {\n      key: item.id,\n      staticClass: \"weui-cell weui-check__label\"\n    }, [_c('span', {\n      staticClass: \"text\"\n    }, [_vm._v(_vm._s(item.name))]), _vm._v(\" \"), _c('radio', {\n      staticClass: \"weui-cell__ft weui-cell__ft_in-radio\",\n      attrs: {\n        \"value\": item.id,\n        \"checked\": item.checked\n      }\n    })], 1)\n  }))], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"weui-btn-area\"\n  }, [_c('button', {\n    staticClass: \"weui-btn\",\n    attrs: {\n      \"formType\": \"submit\",\n      \"type\": \"primary\"\n    }\n  }, [_vm._v(\"提交租车订单\")])], 1)])], 1)\n}\nvar staticRenderFns = []\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-0a4db1dd\", esExports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/mpvue-loader/lib/template-compiler?{\"id\":\"data-v-0a4db1dd\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./node_modules/mpvue-loader/lib/selector.js?type=template&index=0!./src/pages/pay/index.vue\n// module id = 212\n// module chunks = 7"],"sourceRoot":""}